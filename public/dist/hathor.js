(()=>{let e={};window.HATHOR=e,e.measurePoints=0,e.SELECTION_STD=0,e.SELECTION_ADDSPHERESHAPE=1,e.SELECTION_ADDCONVEXPOINT=2,e.SELECTION_MEASURE=3,e.SELECTION_EDITNODES=4,e.SELECTION_ANNOTATION=5,e.REMOVE_OBJECT=6,e._annotationToolbar=void 0,exist=e=>!(null==e);let t=0,i=0,o=0,n=!1;e.init=(a,s,d,r,l,c,N,T,p,O,A,S)=>{ATON.FE.realize(),e.paramSID=exist(a)?a:ATON.FE.urlParams.get("s"),e.paramPhoton=exist(s)?s:ATON.FE.urlParams.get("photon"),e.paramEdit=exist(d)?d:ATON.FE.urlParams.get("edit"),e.paramProf=exist(r)?r:ATON.FE.urlParams.get("pr"),e.paramRLOG=exist(l)?l:ATON.FE.urlParams.get("rlog"),e.paramUIP=exist(c)?c:ATON.FE.urlParams.get("uip"),e.paramTB=exist(N)?N:ATON.FE.urlParams.get("tb"),e.paramBack=exist(T)?T:ATON.FE.urlParams.get("back");let u=exist(p)?p:ATON.FE.urlParams.get("bvh"),m=exist(O)?O:ATON.FE.urlParams.get("tsb"),E=exist(A)?A:ATON.FE.urlParams.get("mret"),v=exist(S)?S:ATON.FE.urlParams.get("autonav");e.sketchfabSearchParam=ATON.FE.urlParams.get("skSearch"),e.paramRLOG&&e.startRLOG(),u&&ATON.Utils.showBVHbounds(parseInt(u)),m&&ATON.MRes.setTSetsDisplayBounds(!0),E&&ATON.MRes.setBaseTSE(parseFloat(E)),e._bPhotonSetup=!1,e._bPhotonReq=!1,e._actState=e.SELECTION_STD,e._bSidePanel=!1,ATON.FE.addBasicLoaderEvents(),e._cPOVind=void 0,e._povs=[],e._povLoopD=void 0,e.uiSetup(),e.suiSetup(),e.setupEventHandlers(),console.log("SID: ",e.paramSID),ATON.FE.loadSceneID(e.paramSID),ATON.addUpdateRoutine(e.update),new THREE.MeshBasicMaterial({color:16777215*Math.random()}),new THREE.MeshBasicMaterial({color:16777215*Math.random()}),v&&e.enableAutoNav(parseFloat(v)),ATON.Photon.on("mousemove_th",(e=>{ATON.evX=e.x,ATON.evY=e.y,ATON._updateScreenMove("mousemove")})),ATON.Photon.on("camerarot_th",(e=>{const n=e.x/window.innerWidth*2-1,a=-e.y/window.innerHeight*2+1;if(0!==t){const e=n-t,o=a-i,s=(ATON.Nav._camera.position.z,new THREE.Vector3(50*-e,50*-o,0));s.applyQuaternion(ATON.Nav._camera.quaternion),ATON.Nav._camera.position.add(s),ATON.Nav._camera.updateWorldMatrix()}t=n,i=a,o=ATON.Nav._camera.position.z})),ATON.Photon.on("camerazoom_th",(e=>{const t=.01*e.delta,i=new THREE.Vector3(0,0,t);i.applyQuaternion(ATON.Nav._camera.quaternion),ATON.Nav._camera.position.add(i),ATON.Nav._camera.updateWorldMatrix()})),ATON.Photon.on("cameramove_th",(e=>{const o=new THREE.Vector3;ATON.Nav._camera.getWorldDirection(o);const n=e.x/window.innerWidth*2-1,a=-e.y/window.innerHeight*2+1;if(0!==t){const e=n-t,o=a-i;console.log("deltaX: ",e," --- deltaY: ",o);const s=new THREE.Vector3(10*e,10*o,0);s.applyQuaternion(ATON.Nav._camera.quaternion),ATON.Nav._camera.position.add(s),ATON.Nav._camera.updateWorldMatrix(),ATON.Nav._controls.target.add(s),ATON.Nav._controls.update()}t=n,i=a})),ATON.Photon.on("reset_coordinates_th",(e=>{t=0,i=0,o=0,n=!1})),ATON.Photon.on("mouseclick_th",(e=>{const t=new PointerEvent("pointerup",{isTrusted:!0,pointerId:1,altKey:!1,altitudeAngle:1.5707963267948966,azimuthAngle:0,bubbles:!0,button:e.kc,buttons:e.btns,cancelBubble:!1,cancelable:!0,clientX:e.x,clientY:e.y,composed:!0,ctrlKey:!1,currentTarget:null,defaultPrevented:!0,detail:0,eventPhase:0,fromElement:null,height:1,isPrimary:!0,layerX:e.x,layerY:e.y,metaKey:!1,movementX:0,movementY:0,offsetX:e.x,offsetY:e.y,pageX:e.x,pageY:e.y,pointerType:"mouse",pressure:0,relatedTarget:null,returnValue:!1,screenX:e.x,screenY:e.y,shiftKey:!1,sourceCapabilities:null,srcElement:ATON._renderer.domElement,tangentialPressure:0,target:ATON._renderer.domElement,tiltX:0,tiltY:0,timeStamp:Date.now(),toElement:null,twist:0,type:"pointerup",view:window,which:1,width:1,x:e.x,y:e.y}),i=new MouseEvent("mousedown_remote",{bubbles:!0,button:e.kc,buttons:e.btns,cancelBubble:!1,cancelable:!0});i.srcEvent=t,ATON._renderer.domElement.dispatchEvent(i)})),ATON.Photon.on("retrieve_popup_th",(t=>{let i="<div id='idPopupContent' class='atonPopup atonPopupLarge'>";i+=e._createPopupStdSem(t.semid)+"</div>";const o={html:i,descr:e.getHTMLDescriptionFromSemNode(t.semid)},n={method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify(o)};try{fetch("https://localhost:8084/new_ann",n).then((e=>console.log(e))).catch((e=>console.log(e)))}catch(e){throw console.error("Error:",e),e}})),ATON.Photon.on("remote_ann_th",(e=>{const t=e.x/window.innerWidth*2-1,i=-e.y/window.innerHeight*2+1;ATON._rcScene.setFromCamera(new THREE.Vector2(t,i),ATON.Nav._camera);let o=[];ATON._rcScene.intersectObjects(ATON._mainRoot.children,!0,o),o.length>0&&console.log("Coordinate 3d: ",o[0].point.x);let n=e.annId,a=ATON.ROOT_NID,s=e.annTxt;const d=Number(e.semtype);let r;if(void 0===n||n.length<2||n===ATON.ROOT_NID)return;if(n===a)return;if(d===ATON.FE.SEMSHAPE_SPHERE&&(r=ATON.SemFactory.createSurfaceSphereFromRemote(n,o[0].point)),d===ATON.FE.SEMSHAPE_CONVEX&&(r=ATON.SemFactory.completeConvexShape(n)),void 0===r)return;let l=ATON.XPFNetwork.getCurrentSemanticGroup();if(l)l.add(r);else{let e=ATON.getSemanticNode(a);e?e.add(r):ATON.getRootSemantics().add(r)}s&&s.length>2&&r.setDescription(s),e.annVoc&&r.setAudio(e.annVoc);let c={semanticgraph:{}};c.semanticgraph.nodes={},c.semanticgraph.nodes[r.nid]={},d===ATON.FE.SEMSHAPE_SPHERE&&(c.semanticgraph.nodes[r.nid].spheres=ATON.SceneHub.getJSONsemanticSpheresList(n)),d===ATON.FE.SEMSHAPE_CONVEX&&(c.semanticgraph.nodes[r.nid].convexshapes=ATON.SceneHub.getJSONsemanticConvexShapes(n)),r.getDescription()&&(c.semanticgraph.nodes[r.nid].description=r.getDescription()),r.getAudio()&&(c.semanticgraph.nodes[r.nid].audio=r.getAudio()),c.semanticgraph.edges=ATON.SceneHub.getJSONgraphEdges(ATON.NTYPES.SEM),console.log(c),ATON.SceneHub._bEdit=!0,ATON.SceneHub.sendEdit(c,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",c),ATON.SceneHub._bEdit=!1})),ATON.Photon.on("switch_convex_mode_th",(t=>{t.data?e._actState=e.SELECTION_ADDCONVEXPOINT:e._actState=e.SELECTION_STD})),ATON.Nav.setHomePOV((new ATON.POV).setPosition(0,3,5).setTarget(1,2,0))},e.startRLOG=()=>{console.log=ATON.Photon.log,console.error=ATON.Photon.log,console.warn=ATON.Photon.log},e.update=()=>{if(ATON._numReqLoad<1&&void 0!==e._povLoopD&&(ATON.Nav.isTransitioning()||e.povNext()),e.paramProf){let e=ATON._renderer.getPixelRatio().toPrecision(2),t="fps: "+parseInt(ATON._fps)+"<br>d: "+e,i=ATON._renderer.info;i&&(t+="<br>G: "+i.memory.geometries,t+="<br>T: "+i.memory.textures),$("#idProf").html(t)}},e.resetSelectionMode=()=>{e._actState===e.SELECTION_EDITNODES&&e.toggleEditNodes(),e._actState=e.SELECTION_STD,$("#btn-ann-convex").removeClass("atonBTN-rec"),$("#btn-ann-sphere").removeClass("atonBTN-rec"),$("#btn-measure").removeClass("atonBTN-rec"),$("#btn-editing").removeClass("atonBTN-rec"),$("#btn-write-annotation").removeClass("atonBTN-rec"),ATON.getUINode("sui_annconvex").switch(!1),ATON.getUINode("sui_ann-sphere").switch(!1),ATON.getUINode("sui_editing").switch(!1),ATON.getUINode("sui_annotation").switch(!1),ATON.getUINode("sui_addmesh").switch(!1),ATON.getUINode("sui_delmesh").switch(!1),ATON.getUINode("sui_scene_layer").switch(!1),ATON.Nav.setUserControl(!0)},e.updateSelectionMode=t=>{e._actState!==t?e.setSelectionMode(t):e.resetSelectionMode()},e.setSelectionMode=t=>{if(void 0!==t)switch(e._actState=t,e._actState){case e.SELECTION_ADDSPHERESHAPE:ATON.getUINode("sui_ann-sphere").switch(!0),$("#btn-ann-sphere").addClass("atonBTN-rec"),$("#btn-write-annotation").removeClass("atonBTN-rec"),$("#btn-ann-convex").removeClass("atonBTN-rec"),$("#btn-measure").removeClass("atonBTN-rec"),$("#btn-editing").removeClass("atonBTN-rec");break;case e.SELECTION_ADDCONVEXPOINT:ATON.getUINode("sui_annconvex").switch(!0),$("#btn-ann-convex").addClass("atonBTN-rec"),$("#btn-write-annotation").removeClass("atonBTN-rec"),$("#btn-ann-sphere").removeClass("atonBTN-rec"),$("#btn-measure").removeClass("atonBTN-rec"),$("#btn-editing").removeClass("atonBTN-rec");break;case e.SELECTION_MEASURE:ATON.getUINode("sui_measure").switch(!0),$("#btn-measure").addClass("atonBTN-rec"),$("#btn-write-annotation").removeClass("atonBTN-rec"),$("#btn-ann-sphere").removeClass("atonBTN-rec"),$("#btn-ann-convex").removeClass("atonBTN-rec"),$("#btn-editing").removeClass("atonBTN-rec");break;case e.SELECTION_EDITNODES:ATON.getUINode("sui_editing").switch(!0),$("#btn-editing").addClass("atonBTN-rec"),$("#btn-write-annotation").removeClass("atonBTN-rec"),$("#btn-measure").removeClass("atonBTN-rec"),$("#btn-ann-sphere").removeClass("atonBTN-rec"),$("#btn-ann-convex").removeClass("atonBTN-rec");break;case e.SELECTION_ANNOTATION:ATON.getUINode("sui_annotation").switch(!0),$("#btn-write-annotation").addClass("atonBTN-rec"),$("#btn-editing").removeClass("atonBTN-rec"),$("#btn-measure").removeClass("atonBTN-rec"),$("#btn-ann-sphere").removeClass("atonBTN-rec"),$("#btn-ann-convex").removeClass("atonBTN-rec")}else e.resetSelectionMode()},e.uiSetup=()=>{if(e.buildUIProfiles(),e.paramUIP?ATON.FE.uiLoadProfile(e.paramUIP):ATON.FE.uiLoadProfile("default"),e.paramTB){let t=e.paramTB.split(",");e.customUIList(t)}},e.setupPhotonEventHandlers=()=>{e._bPhotonSetup||(ATON.Photon.on("AFE_DeleteNode",(e=>{let t=e.nid,i=e.t;void 0!==t&&void 0!==i&&i===ATON.NTYPES.SEM&&ATON.SemFactory.deleteSemanticNode(t)})),ATON.Photon.on("AFE_ClearMeasurements",(()=>{ATON.SUI.clearMeasurements()})),ATON.Photon.on("AFE_NodeSwitch",(e=>{let t,i=e.nid;void 0!==i&&(t=e.t===ATON.NTYPES.SEM?ATON.getSemanticNode(i):ATON.getSceneNode(i),void 0!==t&&t.toggle(e.v))})),ATON.Photon.on("NodeNewPosition",(e=>{let t=e.nid,i=e.pos;ATON.getSceneNode(t).setPosition(i.x,void 0,i.z)})),ATON.Photon.on("sketchfabSpawn",(e=>{let t=e.assetId,i=e.point,o=e.scale;ATON.createSceneNode("sample-skf").loadSketchfabAsset(t).setPosition(i).setScale(o).attachToRoot()})),ATON.Photon.on("nodeSpawn",(e=>{})),ATON.Photon.on("NodeNewRotation",(e=>{let t=e.nid,i=e.rot;ATON.getSceneNode(t).setRotation(i.x,i.y,i.z)})),ATON.Photon.on("StartEditNode",(e=>{ATON.FE.nowEditingNodes.push(e)})),ATON.Photon.on("StopEditNode",(e=>{ATON.FE.nowEditingNodes=ATON.FE.nowEditingNodes.filter((t=>t!==e))})),ATON.Photon.on("AFE_LightSwitch",(e=>{ATON.toggleMainLight(e)})),ATON.on("Photon_IDassigned",(e=>{$("#btn-talk").show()})),ATON.on("Photon_Disconnected",(()=>{$("#btn-talk").hide()})),ATON.on("Photon_UVideo",(e=>{let t=e.video,i=e.uid,o=ATON.Photon.avatarList[i];o&&(o._elVStream?o.toggleStreamPanel(!0):(o.realizeStreamPanel(),o.userlabelnode.add(o.getStreamPanel())),o._elVStream.src=t,o._elVStream.paused&&o._elVStream.play())})),e._bPhotonSetup=!0)},e.finalizeCurrentTask=()=>{ATON.SemFactory.isBuildingShape()&&(e.popupAddSemantic(ATON.FE.SEMSHAPE_CONVEX),$("#btn-cancel").hide())},e.cancelCurrentTask=()=>{ATON.SemFactory.isBuildingShape()&&ATON.SemFactory.stopCurrentConvex(),ATON.SemFactory.nowAnnotating&&(ATON.SemFactory.nowAnnotating=!1),!0===ATON.FE.editMode&&(ATON.FE.editMode=!1,ATON.actualEditingNode&&ATON.actualEditingNode.setNowEditing(!1)),ATON.SemFactory.stopAnnotating(),e._annotationToolbar.hide(),$("#btn-cancel").hide(),e.resetSelectionMode()},e.measure=()=>{let e=ATON.getSceneQueriedPoint(),t=ATON.SUI.addMeasurementPoint(e);if(void 0===t)return;let i=ATON.Utils.generateID("meas"),o={measurements:{}};o.measurements[i]={},o.measurements[i].points=[parseFloat(t.A.x.toPrecision(ATON.SceneHub.FLOAT_PREC)),parseFloat(t.A.y.toPrecision(ATON.SceneHub.FLOAT_PREC)),parseFloat(t.A.z.toPrecision(ATON.SceneHub.FLOAT_PREC)),parseFloat(t.B.x.toPrecision(ATON.SceneHub.FLOAT_PREC)),parseFloat(t.B.y.toPrecision(ATON.SceneHub.FLOAT_PREC)),parseFloat(t.B.z.toPrecision(ATON.SceneHub.FLOAT_PREC))],ATON.SceneHub.sendEdit(o,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",o)},e.switchUserScale=()=>{0===ATON._ws?ATON.setUserScaleLevel(ATON.SCALE_BIG):ATON.setUserScaleLevel(ATON.SCALE_DEFAULT)},e.enableAutoNav=t=>{e._povLoopD=t,ATON.Nav.setUserControl(!1)},e.disableAutoNav=()=>{e._povLoopD=void 0,ATON.Nav.setUserControl(!0)},e.povNext=()=>{let t=e._povs.length;if(t<1)return;void 0===e._cPOVind?e._cPOVind=0:e._cPOVind=(e._cPOVind+1)%t;let i=e._povs[e._cPOVind],o=ATON.XR._bPresenting?ATON.XR.STD_TELEP_DURATION:1;void 0!==e._povLoopD&&(o=e._povLoopD),ATON.Nav.requestPOV(i,o)},e.povPrev=()=>{let t=e._povs.length;if(t<1)return;void 0===e._cPOVind?e._cPOVind=t-1:e._cPOVind=e._cPOVind-1,e._cPOVind<0&&(e._cPOVind=t-1);let i=e._povs[e._cPOVind],o=ATON.XR._bPresenting?ATON.XR.STD_TELEP_DURATION:1;void 0!==e._povLoopD&&(o=e._povLoopD),ATON.Nav.requestPOV(i,o)},e.uiUpdatePOVs=()=>{e._povs=[];for(let t in ATON.Nav.povlist){let i=ATON.Nav.povlist[t];e._povs.push(i)}e._povs.length>0?(e._cPOVind=void 0,$("#btn-prev").show(),$("#btn-next").show()):(e._cPOVind=void 0,$("#btn-prev").hide(),$("#btn-next").hide())},e.addLightProbe=()=>{if(!ATON.SUI.mainSelector.visible)return;let e=ATON.SUI.mainSelector.position,t=ATON.SUI.getSelectorRadius();ATON.addLightProbe((new ATON.LightProbe).setPosition(e).setNear(t)),ATON.getRootScene().assignLightProbesByProximity(),ATON.updateLightProbes(),ATON.Utils.setVectorPrecision(e,4);let i={environment:{}};i.environment.lightprobes={},i.environment.lightprobes.list={};let o=ATON.Utils.generateID("LP");i.environment.lightprobes.list[o]={},i.environment.lightprobes.list[o].pos=[e.x,e.y,e.z],i.environment.lightprobes.list[o].near=t,ATON.SceneHub.sendEdit(i,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",i)},e._createPopupStdSem=e=>{let t="";if(t="<div class='atonPopupTitle'>",t+=void 0===e?"New Annotation</div>":"Modify '"+e+"'</div>",void 0===e){t+="ID:<input id='semid' type='text' maxlength='15' size='15' list='semlist' >&nbsp;",t+="<datalist id='semlist'>";for(let e in ATON.semnodes)e===ATON.ROOT_NID||e.startsWith(ATON.XPFNetwork.SEMGROUP_PREFIX)||(t+="<option>"+e+"</option>");t+="</datalist>",t+="<br><div id='btnRichContent' class='atonBTN atonBTN-gray atonBTN-horizontal'><img src='"+ATON.FE.PATH_RES_ICONS+"html.png'>Rich Content</div>",t+="<div id='idSemDescCont' style='display:none'><textarea id='idSemDescription' style='width:100%;'></textarea></div>"}else t+="<textarea id='idSemDescription' style='width:100%;'></textarea><br>";return ATON.Utils.isConnectionSecure()&&!ATON.MediaFlow.isAudioRecording()&&(t+="<div id='btnVocalNote' class='atonBTN atonBTN-gray atonBTN-horizontal'><img src='"+ATON.FE.PATH_RES_ICONS+"talk.png'>Vocal Note</div>",t+="<br><audio id='ctrlVocalNote' style='display:none' controls ></audio>"),t+="<br>",t+=void 0===e?"<div class='atonBTN atonBTN-green atonBTN-horizontal' id='idAnnOK'>ADD</div>":"<div class='atonBTN atonBTN-green atonBTN-horizontal' id='idAnnOK'>DONE</div>",t},e.createSemanticTextEditor=e=>(document.getElementById(e),$("#"+e).sceditor({id:"idSCEditor",width:"100%",height:"300px",resizeEnabled:!1,autoExpand:!0,emoticonsEnabled:!1,autoUpdate:!0,style:"vendors/sceditor/minified/themes/content/default.min.css",toolbar:"bold,italic,underline,link,unlink,font,size,color,removeformat|left,center,right,justify|bulletlist,orderedlist,table,code|image,youtube|source"}).sceditor("instance")),e.popupAddSemantic=(t,i)=>{if(void 0===ATON._queryDataScene)return;let o=e._createPopupStdSem(i);if(void 0===t&&(t=ATON.FE.SEMSHAPE_SPHERE),t===ATON.FE.SEMSHAPE_CONVEX&&!ATON.SemFactory.bConvexBuilding)return;if(!ATON.FE.popupShow(o,"atonPopupLarge"))return;$("#btnRichContent").click((()=>{$("#idSemDescCont").toggle()}));let n,a=e.createSemanticTextEditor("idSemDescription");if(void 0===i)ATON.FE.uiAttachInputFilterID("semid"),$("#semid").on("input",(()=>{let t=$("#semid").val(),i=e.getHTMLDescriptionFromSemNode(t);void 0!==i&&a.setWysiwygEditorValue(i)}));else{let t=e.getHTMLDescriptionFromSemNode(i);void 0!==t&&a.setWysiwygEditorValue(t)}let s=!1;ATON.on("AudioRecordCompleted",(e=>{n=e,$("#ctrlVocalNote").attr("src",e)})),$("#btnVocalNote").click((()=>{ATON.MediaFlow.isAudioRecording()?($("#btnVocalNote").attr("class","atonBTN"),$("#btnVocalNote").html("<img src='"+ATON.FE.PATH_RES_ICONS+"talk.png'>Vocal Note"),ATON.MediaFlow.stopRecording(),$("#ctrlVocalNote").show(),s=!1):(s=!0,$("#btnVocalNote").attr("class","atonBTN atonBTN-rec"),$("#btnVocalNote").html("<img src='"+ATON.FE.PATH_RES_ICONS+"rec.png'>STOP Recording"),ATON.MediaFlow.startRecording())})),$("#idAnnOK").click((()=>{if(s&&void 0===n)return;$("#semid").blur(),$("#idSemDescription").blur();let e=$("#semid").val(),o=$("#psemid").val();o||(o=ATON.ROOT_NID);let a,d=JSON.stringify($("#idSemDescription").val());if(ATON.FE.popupClose(),void 0===i){if(void 0===e||e.length<2||e===ATON.ROOT_NID)return;if(e===o)return;if(t===ATON.FE.SEMSHAPE_SPHERE&&(a=ATON.SemFactory.createSurfaceSphere(e)),t===ATON.FE.SEMSHAPE_CONVEX&&(a=ATON.SemFactory.completeConvexShape(e)),void 0===a)return;let i=ATON.XPFNetwork.getCurrentSemanticGroup();if(i)i.add(a);else{let e=ATON.getSemanticNode(o);e?e.add(a):ATON.getRootSemantics().add(a)}}else if(a=ATON.getSemanticNode(i),void 0===a)return;d&&d.length>2&&a.setDescription(d),n&&a.setAudio(n);let r={semanticgraph:{}};r.semanticgraph.nodes={},r.semanticgraph.nodes[a.nid]={},void 0===i&&(t===ATON.FE.SEMSHAPE_SPHERE&&(r.semanticgraph.nodes[a.nid].spheres=ATON.SceneHub.getJSONsemanticSpheresList(e)),t===ATON.FE.SEMSHAPE_CONVEX&&(r.semanticgraph.nodes[a.nid].convexshapes=ATON.SceneHub.getJSONsemanticConvexShapes(e))),a.getDescription()&&(r.semanticgraph.nodes[a.nid].description=a.getDescription()),a.getAudio()&&(r.semanticgraph.nodes[a.nid].audio=a.getAudio()),r.semanticgraph.edges=ATON.SceneHub.getJSONgraphEdges(ATON.NTYPES.SEM),ATON.SceneHub.sendEdit(r,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",r)}))},e.getHTMLDescriptionFromSemNode=e=>{let t=ATON.getSemanticNode(e);if(void 0===t)return;let i=t.getDescription();return void 0!==i?(i=JSON.parse(i),i):void 0},e.toggleSideSemPanel=(t,i)=>{t?($("#idSemPanel").show(0),$("#idTopToolbar").hide(),$("#idBottomToolbar").hide(),$("#idBottomRToolbar").hide(),i&&$("#idSemPanel").html(i),ATON.FE._bPopup=!0,e._bSidePanel=!0):(ATON.FE._auSemNode&&ATON.FE._auSemNode.stop(),$("#idSemPanel").hide(0),$("#idSemPanelBG").hide(0),$("#idTopToolbar").show(),$("#idBottomToolbar").show(),$("#idBottomRToolbar").show(),ATON.FE._bPopup=!1,e._bSidePanel=!1,$("#idSemPanel").html(""))},e.sideSemDescription=t=>{if(void 0===t)return;ATON.FE._auSemNode&&ATON.FE._auSemNode.stop(),ATON.FE.playAudioFromSemanticNode(t);let i=e.getHTMLDescriptionFromSemNode(t);if(void 0===i)return void e.toggleSideSemPanel(!1);let o="<div class='atonSidePanelHeader'>";o+="<div class='atonSidePanelCloseBTN atonBTN atonBTN-pulseRed' onclick='HATHOR.toggleSideSemPanel(false)'><img src='"+ATON.FE.PATH_RES_ICONS+"cancel.png'></div>",ATON.SceneHub._bEdit&&(o+="<div class='atonSidePanelTopRightBTN atonBTN' id='btnEditSem' style='display:none;'><img src='"+ATON.FE.PATH_RES_ICONS+"edit.png'></div>"),o+=t+"</div>",o+="<div class='atonSidePanelContent'>"+i+"</div>",e.toggleSideSemPanel(!0,o),ATON.FE.checkAuth((i=>{i.username&&($("#btnEditSem").show(),$("#btnEditSem").click((()=>{e.toggleSideSemPanel(!1),ATON.FE.subPopup((()=>{e.popupAddSemantic(void 0,t)}))})))}))},e.popupSemDescription=t=>{if(void 0===t)return;ATON.FE.playAudioFromSemanticNode(t);let i=e.getHTMLDescriptionFromSemNode(t);if(void 0===i)return;let o="<div class='atonPopupTitle'>";ATON.SceneHub._bEdit&&(o+="<div class='atonBTN' id='btnEditSem' style='display:none;'><img src='"+ATON.FE.PATH_RES_ICONS+"edit.png'></div>"),o+=t+"</div>",o+="<div class='atonPopupDescriptionContainer'>"+i+"</div>",ATON.FE.popupShow(o,"atonPopupCompact")&&ATON.FE.checkAuth((i=>{i.username&&($("#btnEditSem").show(),$("#btnEditSem").click((()=>{ATON.FE.subPopup((()=>{e.popupAddSemantic(void 0,t)}))})))}))},e.popupExportSemShapes=()=>{let e="<div class='atonPopupTitle'>Export</div>";e+="<label for='semid'>Semantic Node ID:</label><br>",e+="<div class='select' style='width:250px;'><select id='semid'>",e+="<option value=''></option>";for(let t in ATON.semnodes)t!==ATON.ROOT_NID&&(e+="<option value='"+t+"'>"+t+"</option>");e+="</select><div class='selectArrow'></div></div><br><br>",e+="<label for='idxformat'>3D format:</label><br>",e+="<div class='select' style='width:150px;'><select id='idxformat'>",e+="<option value='.glb'>GLTF (*.glb)</option>",e+="<option value='.obj'>OBJ</option>",e+="</select><div class='selectArrow'></div></div>",e+="<br><br>",e+="<div class='atonBTN atonBTN-green' id='idExport' style='width:80%'><img src='"+ATON.FE.PATH_RES_ICONS+"download.png'>EXPORT</div>",ATON.FE.popupShow(e)&&$("#idExport").click((()=>{let e=$("#semid").val(),t=$("#idxformat").val();if(e.length>0){let i=ATON.getSemanticNode(e);if(i)for(let o in i.children)ATON.Utils.exportNode(i.children[o],e+String(o)+t)}}))},e.popupSceneInfo=()=>{let t=ATON.SceneHub.getTitle();void 0===t&&(t=ATON.SceneHub.currID);let i=ATON.SceneHub.getDescription(),o="";o+="<div class='atonPopupTitle'>",ATON.SceneHub._bEdit&&(o+="<div class='atonBTN' id='btnEditInfo' style='display:none;'><img src='"+ATON.FE.PATH_RES_ICONS+"edit.png'></div>"),o+=t+"</div>",i&&(o+="<div class='atonPopupDescriptionContainer'>"+JSON.parse(i)+"</div>"),o+="<div class='atonBTN atonBTN-green' id='btnOK' style='width:90%'>OK</div>",ATON.FE.popupShow(o,"atonPopupCompact")&&($("#btnOK").click((()=>{ATON.FE.popupClose()})),ATON.FE.checkAuth((t=>{t.username&&($("#btnEditInfo").show(),$("#btnEditInfo").click((()=>{ATON.FE.subPopup(e.popupEditSceneInfo)})))})))},e.popupCC=()=>{let e="<div class='atonPopupTitle'>Assets Copyright</div>";e+="<div style='text-align:left;'>",e+="Assets referenced in this scene contain "+ATON.CC.list.length+" copyright information<br>";for(let t in ATON.CC.list){let i=ATON.CC.list[t];e+="<div class='atonBlockRound' style='display:block; max-width:400px'>";for(let t in i)e+="<strong>"+t+"</strong>: "+ATON.Utils.URLify(i[t])+"<br>";e+="</div>"}e+="</div>",ATON.FE.popupShow(e)},e.popupPOV=()=>{let t=ATON.Nav.copyCurrentPOV();console.log(t);let i,o="<div class='atonPopupTitle'>Viewpoint</div>";o+="<div class='atonBlockRound' style='padding:2px; display:block; background-color:rgba(0,255,0, 0.1)'>",o+="<div style='text-align:right;'>",o+="<strong>Position</strong>: <input id='idPOVeye' type='text' size='20' placeholder='x,y,z' value='"+t.pos.x.toPrecision(3)+","+t.pos.y.toPrecision(3)+","+t.pos.z.toPrecision(3)+"'><br>",o+="<strong>Target</strong>: <input id='idPOVtgt' type='text' size='20' placeholder='x,y,z' value='"+t.target.x.toPrecision(3)+","+t.target.y.toPrecision(3)+","+t.target.z.toPrecision(3)+"'><br>",o+="<strong>FoV</strong>: <input id='idPOVfov' type='text' size='20' placeholder='f' value='"+t.fov+"'><br>",o+="</div>",o+="<div class='atonBTN atonBTN-green atonBTN-horizontal atonBTN-text' id='btnPOVgo'><img src='"+ATON.FE.PATH_RES_ICONS+"pov.png'>Go</div>",o+="</div><br>",o+="<div class='atonBTN atonBTN-gray atonBTN-horizontal atonBTN-text' id='btnPOVsetHome'><img src='"+ATON.FE.PATH_RES_ICONS+"home.png'>Set as Home</div><br>",o+="<div class='atonBlockRound' style='padding:2px; display:block; background-color:rgba(255,255,2555, 0.1)'>",o+="<div class='atonBTN atonBTN-gray atonBTN-horizontal atonBTN-text' id='btnPOVadd'><img src='"+ATON.FE.PATH_RES_ICONS+"pov.png'>Add current viewpoint</div>",o+="as: <input id='idPOVid' type='text' size='15' placeholder='Viewpoint-ID' value='"+ATON.Utils.generateID("pov")+"'></div>",ATON.FE.popupShow(o)&&($("#btnPOVgo").click((()=>{let e=$("#idPOVeye").val(),t=$("#idPOVtgt").val(),i=$("#idPOVfov").val();if(e=e.split(","),t=t.split(","),3!==e.length||3!==t.length)return;let o=new ATON.POV;o.setPosition(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2])),o.setTarget(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2])),o.setFOV(parseFloat(i)),ATON.Nav.requestPOV(o)})),$("#btnPOVsetHome").click((()=>{i="home",ATON.Nav.setHomePOV(t),ATON.FE.popupClose();let e={viewpoints:{}};e.viewpoints[i]={},e.viewpoints[i].position=[t.pos.x,t.pos.y,t.pos.z],e.viewpoints[i].target=[t.target.x,t.target.y,t.target.z],e.viewpoints[i].fov=t.fov,ATON.SceneHub.sendEdit(e,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",e)})),$("#btnPOVadd").click((()=>{if(i=$("#idPOVid").val().trim(),i.length<3)return;t.as(i),ATON.Nav.addPOV(t),e.uiUpdatePOVs(),ATON.FE.popupClose();let o={viewpoints:{}};o.viewpoints[i]={},o.viewpoints[i].position=[t.pos.x,t.pos.y,t.pos.z],o.viewpoints[i].target=[t.target.x,t.target.y,t.target.z],o.viewpoints[i].fov=t.fov,ATON.SceneHub.sendEdit(o,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",o)})))},e.popupGraphs=()=>{let e="<div class='atonPopupTitle'>Layers</div>";ATON.useGizmo(!0),e+="<div>";let t="<div style='display:inline-block; text-align:left; margin:10px; vertical-align:top; min-width:150px;'>";if(e+=t,e+=ATON.FE.uiCreateGraph(ATON.NTYPES.SCENE),e+="</div>",e+=t,e+="<input type='checkbox' "+(ATON._rootSem.visible?"checked":"")+" id='idToggleSem'>Semantic Annotations",e+="</div>",ATON.SUI.gMeasures.children.length>0){let i=ATON.SUI.gMeasures.visible?"checked":"";e+=t,e+="<div style='text-align:center'><b>MEASUREMENTS</b></div><br>",e+="<div class='atonBTN atonBTN-red' style='width:100%' id='btnClearMeas'><img src='"+ATON.FE.PATH_RES_ICONS+"trash.png'>Delete all</div>",e+="<input type='checkbox' "+i+' onchange="ATON.SUI.gMeasures.toggle(this.checked);">Show<br>',e+="</div>"}ATON.FE.popupShow(e)&&($("#idToggleSem").click((()=>{ATON._rootSem.toggle()})),$("#btnClearMeas").click((()=>{ATON.SUI.clearMeasurements();ATON.SceneHub.sendEdit({measurements:{}},ATON.SceneHub.MODE_DEL),ATON.Photon.fireEvent("AFE_ClearMeasurements")})),$("#idNewNID").click((()=>{ATON.FE.subPopup((()=>{ATON.FE.popupNewNode(ATON.NTYPES.SCENE)}))})))},e.popupEnvironment=()=>{let e="<div class='atonPopupTitle'>Environment</div>";e+="<div style='text-align:left'>";let t=ATON.isMainLightEnabled(),i=ATON._renderer.shadowMap.enabled;e+="<div style='text-align:center;'>Exposure (<span id='idExpVal'></span>)<br>",e+="<input id='idExposure' type='range' min='0.05' max='10.0' step='0.05' >",e+="</div><br>";let o=t?"checked":"";if(e+="<div id='idOptLight' class='atonOptionBlockShort' >",e+="<input type='checkbox' id='idDirLight' "+o+"><b>Direct light</b><br>",e+="<img src='"+ATON.FE.PATH_RES_ICONS+"light.png' class='atonDefIcon' style='float:left'>you can enable a main directional light (you can control it by pressing 'l' key)</div>",o=i?"checked":"",e+="<div id='idOptShadows' class='atonOptionBlockShort' >",e+="<input type='checkbox' id='idShadows' "+o+"><b>Shadows</b><br>",e+="you can enable real-time shadows (warning, this may impact performances)</div>",o=ATON._bAutoLP?"checked":"",e+="<div id='idOptAutoLP' class='atonOptionBlockShort' >",e+="<input type='checkbox' id='idAutoLP' "+o+"><b>Auto Light-Probe</b><br>",e+="<img src='"+ATON.FE.PATH_RES_ICONS+"lp.png' class='atonDefIcon' style='float:left'>this option estimates location and radius of a light-probe</div>","editor"===ATON.FE.getCurrentUIP()&&(e+="<br><br>",e+="<div style='text-align:center;'>",e+="Select panorama from collection or URL: <input id='idPanoURL' type='text' size='30'>",e+="<div id='idClearPano' class='atonBTN'><img src='"+ATON.FE.PATH_RES_ICONS+"search-clear.png'></div><div id='idSetPano' class='atonBTN atonBTN-green'>Set</div><br>",e+="<div id='idPanoPreview' style='margin:auto;'></div>",e+="</div><br>",e+="<div style='text-align:center;'>Panorama rotation (<span id='idEnvRotVal'></span>)<br>",e+="<input id='idEnvRot' type='range' min='0.0' max='1.0' step='0.02' >",e+="</div><br>"),ATON.getNumLightProbes()>0&&(e+="<br><div id='idUpdLPs' class='atonBTN atonBTN-text atonBTN-green'><img src='"+ATON.FE.PATH_RES_ICONS+"lp.png'>Update all LightProbes</div><br>"),ATON.FX.composer&&(e+="<details><summary><b>Advanced Effects</b></summary>",o=ATON.FX.isPassEnabled(ATON.FX.PASS_AO)?"checked":"",e+="<div class='atonOptionBlockShort' >",e+="<input type='checkbox' id='idFXPassSAO' "+o+"><b>Ambient Occlusion</b><br>",e+="Enable or disable real-time Ambient Occlusion<br><br>",e+="Intensity (<span id='idFXAOintVal'></span>)<br><input id='idFXAOint' type='range' min='0.1' max='0.5' step='0.05' >",e+="</div>",o=ATON.FX.isPassEnabled(ATON.FX.PASS_BLOOM)?"checked":"",e+="<div class='atonOptionBlockShort' >",e+="<input type='checkbox' id='idFXPassBloom' "+o+"><b>Bloom</b><br>",e+="Enable or disable real-time bloom<br><br>",e+="Strength (<span id='idFXBloomStrengthVal'></span>)<br><input id='idFXBloomStrength' type='range' min='0.1' max='3.0' step='0.01' ><br>",e+="Threshold (<span id='idFXBloomThresholdVal'></span>)<br><input id='idFXBloomThreshold' type='range' min='0.1' max='1.0' step='0.01' ><br>",e+="</div>",o=ATON.FX.isPassEnabled(ATON.FX.PASS_DOF)?"checked":"",e+="<div class='atonOptionBlockShort' >",e+="<input type='checkbox' id='idFXPassDOF' "+o+"><b>Depth of Field</b><br>",e+="Enable or disable real-time DOF<br><br>",e+="</div>",e+="</details>"),e+="</div>",!ATON.FE.popupShow(e))return;let n={environment:{}};ATON.FE.uiAttachCollectionItemsToInput("idPanoURL","panoramas"),$("#idPanoURL").on("change",(()=>{let e=$("#idPanoURL").val();e&&e.length>0?(e.startsWith("http")||(e=ATON.PATH_COLLECTION+e),ATON.Utils.isVideo(e)?$("#idPanoPreview").html("<video src='"+e+"' autoplay='true' style='width:90%;height:auto'>"):$("#idPanoPreview").html("<img src='"+e+"' style='width:90%;height:auto'>")):$("#idPanoPreview").html("")})),$("#idClearPano").click((()=>{$("#idPanoURL").val(""),$("#idPanoPreview").html("")})),$("#idSetPano").click((()=>{let e=$("#idPanoURL").val();ATON.setMainPanorama(e),n.environment.mainpano={},n.environment.mainpano.url=e,ATON.SceneHub.sendEdit(n,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",n)})),$("#idUpdLPs").click((()=>{ATON.updateLightProbes()}));let a=ATON.getExposure();$("#idExposure").val(a),$("#idExpVal").html(a);let s=ATON.FX.getAOintensity();$("#idFXAOint").val(s),$("#idFXAOintVal").html(s);let d=ATON.FX.getBloomStrength();$("#idFXBloomStrength").val(d),$("#idFXBloomStrengthVal").html(d);let r=ATON.FX.getBloomThreshold();$("#idFXBloomThreshold").val(r),$("#idFXBloomThresholdVal").html(r),t?$("#idOptShadows").show():$("#idOptShadows").hide(),$("#idFXAOint").on("input change",(()=>{let e=parseFloat($("#idFXAOint").val());ATON.FX.setAOintensity(e),$("#idFXAOintVal").html(e),ATON.FX.isPassEnabled(ATON.FX.PASS_AO)&&ATON.SceneHub.sendEdit({fx:{ao:{i:e.toPrecision(ATON.SceneHub.FLOAT_PREC)}}},ATON.SceneHub.MODE_ADD)})),$("#idFXBloomStrength").on("input change",(()=>{let e=parseFloat($("#idFXBloomStrength").val());ATON.FX.setBloomStrength(e),$("#idFXBloomStrengthVal").html(e),ATON.FX.isPassEnabled(ATON.FX.PASS_BLOOM)&&ATON.SceneHub.sendEdit({fx:{bloom:{i:e.toPrecision(ATON.SceneHub.FLOAT_PREC)}}},ATON.SceneHub.MODE_ADD)})),$("#idFXBloomThreshold").on("input change",(()=>{let e=parseFloat($("#idFXBloomThreshold").val());ATON.FX.setBloomThreshold(e),$("#idFXBloomThresholdVal").html(e),ATON.FX.isPassEnabled(ATON.FX.PASS_BLOOM)&&ATON.SceneHub.sendEdit({fx:{bloom:{t:e.toPrecision(ATON.SceneHub.FLOAT_PREC)}}},ATON.SceneHub.MODE_ADD)})),$("#idExposure").on("input change",(()=>{let e=parseFloat($("#idExposure").val());ATON.setExposure(e),$("#idExpVal").html(e),n.environment.exposure=e,ATON.SceneHub.sendEdit(n,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",n)})),$("#idDirLight").on("change",(()=>{let e=$("#idDirLight").is(":checked");if(e){let e=ATON.getMainLightDirection();void 0===e&&(e=new THREE.Vector3(0,-1,1)),ATON.setMainLightDirection(e),$("#idOptShadows").show(),n.environment.mainlight={},n.environment.mainlight.direction=[e.x,e.y,e.z],ATON.SceneHub.sendEdit(n,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",n)}else $("#idOptShadows").hide(),n.environment.mainlight={},ATON.SceneHub.sendEdit(n,ATON.SceneHub.MODE_DEL),ATON.Photon.fireEvent("AFE_LightSwitch",!1);ATON.toggleMainLight(e)})),$("#idShadows").on("change",(()=>{let e=$("#idShadows").is(":checked");ATON.toggleShadows(e),ATON.getMainLightDirection(),ATON.isMainLightEnabled()&&(n.environment.mainlight={},n.environment.mainlight.shadows=e,ATON.SceneHub.sendEdit(n,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",n),ATON.updateLightProbes())})),$("#idEnvRot").on("input change",(()=>{let e=parseFloat($("#idEnvRot").val()*Math.PI*2).toPrecision(4);ATON.setMainPanoramaRotation(e),$("#idEnvRotVal").html(e),n.environment.mainpano={},n.environment.mainpano.rotation=e,ATON.SceneHub.sendEdit(n,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",n)})),$("#idAutoLP").on("change",(()=>{let e=$("#idAutoLP").is(":checked");ATON.setAutoLP(e),e&&ATON.updateLightProbes(),n.environment.lightprobes={},n.environment.lightprobes.auto=e,ATON.SceneHub.sendEdit(n,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",n)})),$("#idFXPassSAO").on("change",(()=>{let e=$("#idFXPassSAO").is(":checked");ATON.FX.togglePass(ATON.FX.PASS_AO,e),e?ATON.SceneHub.sendEdit({fx:{ao:{i:ATON.FX.getAOintensity().toPrecision(ATON.SceneHub.FLOAT_PREC)}}},ATON.SceneHub.MODE_ADD):ATON.SceneHub.sendEdit({fx:{ao:{}}},ATON.SceneHub.MODE_DEL)})),$("#idFXPassBloom").on("change",(()=>{let e=$("#idFXPassBloom").is(":checked");e?ATON.SceneHub.sendEdit({fx:{bloom:{i:ATON.FX.getBloomStrength().toPrecision(ATON.SceneHub.FLOAT_PREC),t:ATON.FX.getBloomThreshold().toPrecision(ATON.SceneHub.FLOAT_PREC)}}},ATON.SceneHub.MODE_ADD):ATON.SceneHub.sendEdit({fx:{bloom:{}}},ATON.SceneHub.MODE_DEL),ATON.FX.togglePass(ATON.FX.PASS_BLOOM,e)})),$("#idFXPassDOF").on("change",(()=>{let e=$("#idFXPassDOF").is(":checked");e?ATON.SceneHub.sendEdit({fx:{dof:{f:ATON.FX.getDOFfocus().toPrecision(ATON.SceneHub.FLOAT_PREC)}}},ATON.SceneHub.MODE_ADD):ATON.SceneHub.sendEdit({fx:{dof:{}}},ATON.SceneHub.MODE_DEL),ATON.FX.togglePass(ATON.FX.PASS_DOF,e)}))},e.popupShare=()=>{let e="<div class='atonPopupTitle'>Share</div>";if(e+="<div class='atonQRcontainer' id='idQRcode'></div><br><br>",e+="<details><summary><b>Embed this Scene</b></summary>",e+="Copy and paste this HTML code in your blog or website to embed an interactive 3D component for this scene<br><br>",e+="<input id='idEmbStaticCover' type='checkbox'>Use static cover<br>",e+="<textarea id='idEmbed' style='width:90%; height:100px; resize:none;' readonly ></textarea><br>",e+="<div class='atonBTN atonBTN-green' style='width:90%' id='btnEmbedCopy'>Copy</div>",e+="</details>",!ATON.FE.popupShow("<div class='atonPopupTitle'>Share</div><div class='atonQRcontainer' id='idQRcode'></div><br><br><details><summary><b>Embed this Scene</b></summary>Copy and paste this HTML code in your blog or website to embed an interactive 3D component for this scene<br><br><input id='idEmbStaticCover' type='checkbox'>Use static cover<br><textarea id='idEmbed' style='width:90%; height:100px; resize:none;' readonly ></textarea><br><div class='atonBTN atonBTN-green' style='width:90%' id='btnEmbedCopy'>Copy</div></details>"))return;let t=window.location.href;new QRCode(document.getElementById("idQRcode"),t);let i="<iframe style='height:500px; margin:0;' src='"+window.location.href+"' width='100%' height='500px' frameborder='0' allow='autoplay; fullscreen; xr-spatial-tracking' xr-spatial-tracking execution-while-out-of-viewport execution-while-not-rendered web-share allowfullscreen mozallowfullscreen='true' webkitallowfullscreen='true'></iframe>",o="<a href='"+window.location.href+"'><img src='"+ATON.PATH_SCENES+ATON.SceneHub.currID+"/cover.png'></a>";$("#idEmbed").val(i),$("#btnEmbedCopy").click((()=>{let e=document.getElementById("idEmbed");e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),ATON.FE.popupClose()})),$("#idEmbStaticCover").on("change",(()=>{$("#idEmbStaticCover").is(":checked")?$("#idEmbed").val(o):$("#idEmbed").val(i)}))},e.popupScene=()=>{if(void 0===ATON.SceneHub.currID)return;let t="<div class='atonPopupTitle'>"+(ATON.SceneHub.getTitle()?ATON.SceneHub.getTitle():ATON.SceneHub.currID)+"</div>";if(ATON.SceneHub.getTitle()&&(t+=ATON.SceneHub.currID+"<br>"),ATON.SceneHub.currData){let e=ATON.SceneHub.currData.kwords;if(e){t+="<div>";for(let i in e)t+="<a class='atonKeyword atonKeywordActivable' href='/?q="+i+"'>"+i+"</a>";t+="</div><br>"}}t+="<div id='btnCover' class='atonCover' style='margin:5px'>",t+="<img src='"+ATON.PATH_RESTAPI+"cover/"+ATON.SceneHub.currID+"' style='width:200px; height:auto'></div>",ATON.FE.checkAuth((i=>{let o=i.username,n=ATON.SceneHub.currID.startsWith(o);t+="<div style='display:inline-block; text-align:left; margin:6px; vertical-align:top; max-width:300px; text-align:center'>",o&&n&&(t+="<div class='atonBTN atonBTN-gray atonBTN-horizontal atonBTN-text' id='btnInfo'><img src='"+ATON.FE.PATH_RES_ICONS+"edit.png'>Edit info</div>"),t+="<div class='atonBTN atonBTN-gray atonBTN-horizontal atonBTN-text' id='btnPopGraphs'><img src='"+ATON.FE.PATH_RES_ICONS+"list.png'>Layers</div>",t+="<div class='atonBTN atonBTN-gray atonBTN-horizontal atonBTN-text' id='btnPopEnv'><img src='"+ATON.FE.PATH_RES_ICONS+"light.png'>Environment</div>",t+="<div class='atonBTN atonBTN-gray atonBTN-horizontal atonBTN-text' id='idMoveAndRotate'><img src='"+ATON.FE.PATH_RES_ICONS+"edit.png'>Move and rotate</div>",t+="<div class='atonBTN atonBTN-gray atonBTN-horizontal atonBTN-text' id='btnSShot'><img src='"+ATON.FE.PATH_RES_ICONS+"sshot.png'>Capture</div>","editor"===ATON.FE.getCurrentUIP()&&(t+="<div class='atonBTN atonBTN-gray atonBTN-horizontal atonBTN-text' id='btnPopPOV'><img src='"+ATON.FE.PATH_RES_ICONS+"pov.png'>Viewpoint</div>"),t+="</div>",o&&(t+="<br><br>",t+="<div class='atonBTN atonBTN-orange atonBTN-horizontal atonBTN-text' id='idSHUclone'><img src='"+ATON.FE.PATH_RES_ICONS+"clone.png'>Clone this Scene</div>",n&&(t+="<div class='atonBTN atonBTN-gray atonBTN-text' id='idSHUscene'><img src='"+ATON.FE.PATH_RES_ICONS+"scene.png'>Manage this Scene</div>",t+="<div class='atonBTN atonBTN-gray atonBTN-text' id='idSHUscenes'><img src='"+ATON.FE.PATH_RES_ICONS+"scene.png'>Manage my Scenes</div>",t+="<br><div class='atonBTN atonBTN-red atonBTN-horizontal atonBTN-text' id='idDelScene'><img src='"+ATON.FE.PATH_RES_ICONS+"trash.png'>Delete this scene</div>")),ATON.FE.popupShow(t)&&(ATON.SceneHub._bEdit?$("#btnInfo").show():$("#btnInfo").hide(),$("#btnPopPOV").click((()=>{ATON.FE.subPopup(e.popupPOV)})),$("#btnPopEnv").click((()=>{ATON.FE.subPopup(e.popupEnvironment)})),$("#btnPopGraphs").click((()=>{ATON.FE.subPopup(e.popupGraphs)})),$("#btnInfo").click((()=>{ATON.FE.subPopup(e.popupEditSceneInfo)})),$("#btnSShot").click((()=>{ATON.FE.subPopup(ATON.FE.popupScreenShot)})),$("#btnCover").click((()=>{ATON.FE.subPopup(ATON.FE.popupScreenShot)})),$("#idSHUscene").click((()=>{void 0!==ATON.SceneHub.currID&&window.open("/shu/scenes/?s="+ATON.SceneHub.currID,"_self")})),$("#idSHUscenes").click((()=>{void 0!==ATON.SceneHub.currID&&window.open("/shu/scenes/","_self")})),$("#idSHUclone").click((()=>{ATON.Utils.postJSON(ATON.PATH_RESTAPI+"clone/scene",{sid:ATON.SceneHub.currID},(e=>{e&&(window.location.href="/s/"+e)}))})),$("#idDelScene").click((()=>{ATON.FE.subPopup(e.popupSceneDelete)})),$("#idMoveAndRotate").click((()=>{ATON.FE.popupClose(),ATON.FE.editMode=!0,$("#btn-cancel").show()})))}))},e.popupEditSceneInfo=()=>{let t="<div class='atonPopupTitle'>Scene information</div>";if(t+="Title: <input id='idSceneTitle' type='text' maxlength='30' size='30' ><br>",t+="<textarea id='idSummaryEditor' style='width:100%'></textarea><br>",t+="<div id='idSceneKWords'></div>",t+="<div class='atonBTN atonBTN-green' id='idSceneSummaryOK' style='width:80%'>DONE</div>",!ATON.FE.popupShow("<div class='atonPopupTitle'>Scene information</div>Title: <input id='idSceneTitle' type='text' maxlength='30' size='30' ><br><textarea id='idSummaryEditor' style='width:100%'></textarea><br><div id='idSceneKWords'></div><div class='atonBTN atonBTN-green' id='idSceneSummaryOK' style='width:80%'>DONE</div>","atonPopupLarge"))return;let i=e.createSemanticTextEditor("idSummaryEditor"),o=ATON.SceneHub.getDescription();o&&i.setWysiwygEditorValue(JSON.parse(o));let n=ATON.SceneHub.getTitle();n&&$("#idSceneTitle").val(n);let a=[];if(ATON.SceneHub.currData&&ATON.SceneHub.currData.kwords)for(let e in ATON.SceneHub.currData.kwords)a.push(e);ATON.FE.uiAddKeywordsArea("idSceneKWords",a,(e=>{let t={kwords:{}};t.kwords[e]=1,ATON.SceneHub.sendEdit(t,ATON.SceneHub.MODE_ADD)}),(e=>{let t={kwords:{}};t.kwords[e]=1,ATON.SceneHub.sendEdit(t,ATON.SceneHub.MODE_DEL)})),$("#idSceneSummaryOK").click((()=>{let e=JSON.stringify($("#idSummaryEditor").val()),t=$("#idSceneTitle").val();ATON.FE.popupClose();let i={};e&&e.length>2&&(ATON.SceneHub.setDescription(e),i.description=e,$("#btn-info").show()),t&&t.length>0&&(ATON.SceneHub.setTitle(t),i.title=t),(i.title||i.description)&&(ATON.SceneHub.sendEdit(i,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",i))}))},e.popupHelp=()=>{let t="<div class='atonPopupTitle'>Hathor <img src='"+ATON.FE.PATH_RES_ICONS+"hathor.png' class='atonDefIcon'> help</div>";t+="<i>Hathor</i> is the official ATON front-end. This advanced web-app can be used to present and interact with 3D models, scenes and panoramic content - with several features built on top of existing ATON functionalities<br><div id='idSettings' class='atonBTN atonBTN-text'><img src='"+ATON.FE.PATH_RES_ICONS+"settings.png'>Settings <span class='atonKey'>'space'</span></div><a class='atonBTN atonBTN-text' href='https://osiris.itabc.cnr.it/aton/index.php/overview/hathor/' target='_blank'><img src='"+ATON.FE.PATH_RES_ICONS+"link.png'>More details</a><br>",t+="<div style='text-align:left;'>";let i="<div style='width:250px; display:inline-block; margin:5px; vertical-align:top;'>";t+="<h3>Icons</h3>",t+=i+"<img src='"+ATON.FE.PATH_RES_ICONS+"home.png' class='atonDefIcon'> Home viewpoint</div>",t+=i+"<img src='"+ATON.FE.PATH_RES_ICONS+"user.png' class='atonDefIcon'> User authentication</div>",t+=i+"<img src='"+ATON.FE.PATH_RES_ICONS+"nav.png' class='atonDefIcon'> Navigation menu</div>",t+=i+"<img src='"+ATON.FE.PATH_RES_ICONS+"prev.png' class='atonDefIcon'><img src='"+ATON.FE.PATH_RES_ICONS+"next.png' class='atonDefIcon'> Previous/Next viewpoint</div>",t+=i+"<img src='"+ATON.FE.PATH_RES_ICONS+"scene.png' class='atonDefIcon'> Current scene</div>",t+=i+"<img src='"+ATON.FE.PATH_RES_ICONS+"fullscreen.png' class='atonDefIcon'> Fullscreen</div>",t+=i+"<img src='"+ATON.FE.PATH_RES_ICONS+"info.png' class='atonDefIcon'> Scene information</div>",ATON.Utils.isConnectionSecure()&&((ATON.Utils.isARsupported()||ATON.Utils.isVRsupported())&&(t+=i+"<img src='"+ATON.FE.PATH_RES_ICONS+"xr.png' class='atonDefIcon'> Immersive, Augmented or Mixed Reality</div>"),ATON.Utils.isMobile()&&(t+=i+"<img src='"+ATON.FE.PATH_RES_ICONS+"devori.png' class='atonDefIcon'> Device orientation mode</div>")),t+="<br><br>";let o="<div style='width:300px; display:inline-block; margin:5px; vertical-align:top;'>";t+=o+"<h3>Navigation</h3>",t+="<ul>",ATON.Utils.isMobile()?(t+="<li><b>Pinch</b>: dolly / zoom</li>",t+="<li><b>Double-tap</b>: retarget on surface (orbit); locomotion (first-person navigation modes)</li>"):(t+="<li><b>Double-click</b>: retarget on surface (orbit); locomotion (first-person navigation modes)</li>",t+="<li><span class='atonKey'>'CTRL' + mouse wheel</span>: increase/decrease field-of-view</li>",t+="<li><span class='atonKey'>'v'</span>: viewpoint</li>",t+="<li><span class='atonKey'>'n'</span>: navigation modes</li>"),t+="</ul></div>",t+=o+"<h3>3D Selector</h3>",t+="<ul>",ATON.Utils.isMobile()?t+="<li><b>Tap</b>: move location of 3D selector</li>":(t+="<li><span class='atonKey'>'SHIFT' + mouse wheel</span>: increase/decrease radius of selector</li>",t+="<li><span class='atonKey'>'space'</span>: Selector options</li>"),t+="</ul></div>",t+=o+"<h3>Annotation</h3>",t+="<ul>",ATON.Utils.isMobile()?t+="<li><b>Double-tap on annotation</b>: open associated content</li>":(t+="<li><span class='atonKey'>'a'</span>: add basic annotation (sphere)</li>",t+="<li><span class='atonKey'>'s'</span>: initiate convex shape annotation (add surface point)</li>",t+="<li><span class='atonKey'>'ENTER'</span>: finalize convex shape annotation</li>",t+="<li><span class='atonKey'>'ESC'</span>: cancel/stop current convex shape annotation</li>",t+="<li><span class='atonKey'>'e'</span>: edit hovered annotation</li>",t+="<li><span class='atonKey'>'CANC'</span>: delete hovered annotation</li>",t+="<li><span class='atonKey'>'x'</span>: export (download) semantic shapes</li>",t+="<li><span class='atonKey'>'m'</span>: add measurement point</li>"),t+="</ul></div>",ATON.Utils.isMobile()||(t+=o+"<h3>Other</h3>",t+="<ul>",t+="<li><span class='atonKey'>'c'</span>: screenshot/capture</li>",t+="</ul></div>"),t+="</div>",ATON.FE.popupShow(t,"atonPopupLarge")&&$("#idSettings").click((()=>{ATON.FE.subPopup(e.popupSettings)}))},e.popupSceneDelete=()=>{let e="<div class='atonPopupTitle'>DELETE this scene?</div>";e+="<div class='atonBTN atonBTN-red' id='btnDELyes'>YES</div>",e+="<div class='atonBTN atonBTN-green' id='btnDELno'>NO</div>",ATON.FE.popupShow("<div class='atonPopupTitle'>DELETE this scene?</div><div class='atonBTN atonBTN-red' id='btnDELyes'>YES</div><div class='atonBTN atonBTN-green' id='btnDELno'>NO</div>")&&($("#btnDELyes").click((()=>{let e=ATON.SceneHub.currID;void 0!==e&&ATON.Utils.postJSON(ATON.PATH_RESTAPI+"del/scene",{sid:e},(e=>{e&&window.open("/shu/scenes/","_self")}))})),$("#btnDELno").click((()=>{ATON.FE.popupClose()})))},e.popupXR=()=>{if(!ATON.Utils.isConnectionSecure())return;let e="<div class='atonPopupTitle'>XR</div>";e+="Available Immersive, Augmented or Mixed Reality,<br>depending on your device and browser.<br><br>",ATON.Utils.isVRsupported()&&(e+="<div id='btnEnterVR' class='atonBTN atonBTN-green atonBTN-text atonBTN-horizontal'><img src='"+ATON.FE.PATH_RES_ICONS+"vr.png'><br>Immersive VR</div><br>"),ATON.Utils.isARsupported()&&(e+="<div id='btnEnterAR' class='atonBTN atonBTN-green atonBTN-text atonBTN-horizontal'><img src='"+ATON.FE.PATH_RES_ICONS+"ar.png'><br>Augmented/Mixed Reality</div><br>");let t=ATON._stdpxd;e+="<details><summary><b>Advanced options</b></summary>",e+="<br>Resolution scale (<span id='idXRfbstxt'>"+t+"</span>):",e+="<input id='idXRfbs' type='range' min='0.25' max='1.0' step='0.25' value='"+t+"'>",e+="</details>",ATON.FE.popupShow(e)&&($("#btnEnterVR").on("click",(()=>{ATON.XR.toggle("immersive-vr"),ATON.FE.popupClose()})),$("#btnEnterAR").on("click",(()=>{ATON.XR.toggle("immersive-ar"),ATON.FE.popupClose()})),$("#idXRfbs").on("input change",(()=>{let e=parseFloat($("#idXRfbs").val());$("#idXRfbstxt").html(e),ATON._renderer.xr.setFramebufferScaleFactor(e)})))},e.popupNav=()=>{let t=ATON.Nav.copyCurrentPOV().pos,i="<div class='atonPopupTitle'>Navigation</div>";i+="<div style='display:block; width:90%; min-height:50px; vertical-align:top'>",i+="<div style='display:inline-block; width:60px; float:left' id='idNMfp'></div>",i+="<div style='text-align:left'>Switch between first-person and orbit navigation mode</div>",i+="</div>",ATON.Utils.isConnectionSecure()&&ATON.Utils.isMobile()&&(i+="<div style='display:block; width:90%; min-height:50px; vertical-align:top'>",i+="<div style='display:inline-block; width:60px; float:left' id='idNMdevori'></div>",i+="<div style='text-align:left'>Enable or disable device-orientation mode</div>",i+="</div>"),ATON.SceneHub._bEdit&&(i+="<div class='atonBTN atonBTN-horizontal' id='btnDefNavMode'>Set current navigation mode as default</div>",i+="<div class='atonBTN atonBTN-green atonBTN-horizontal' id='btnAddLocNode'>Add Locomotion Node here</div>",ATON.Nav._locNodes.length>0&&(i+="<div class='atonBTN atonBTN-red atonBTN-horizontal' id='btnDelLocNodes'>Remove all Locomotion Nodes</div>")),i+="<div class='atonBTN atonBTN-horizontal' id='btnViewpoint'><img src='"+ATON.FE.PATH_RES_ICONS+"pov.png'>Viewpoint</div>",ATON.FE.popupShow(i)&&(ATON.FE.uiAddButtonFirstPerson("idNMfp"),ATON.FE.uiAddButtonDeviceOrientation("idNMdevori"),$("#btnViewpoint").click((()=>{ATON.FE.subPopup((()=>{e.popupPOV()}))})),$("#btnDefNavMode").click((()=>{let e={};e.navmode=ATON.Nav._mode,ATON.SceneHub.sendEdit(e,ATON.SceneHub.MODE_ADD),ATON.FE.popupClose()})),$("#btnAddLocNode").click((()=>{lnid=ATON.Utils.generateID("ln"),ATON.Nav.addLocomotionNode(t.x,t.y,t.z,!0);let e={locomotionGraph:{}};e.locomotionGraph[lnid]={},e.locomotionGraph[lnid].pos=[t.x.toPrecision(3),t.y.toPrecision(3),t.z.toPrecision(3)],ATON.SceneHub.sendEdit(e,ATON.SceneHub.MODE_ADD),ATON.Photon.fireEvent("AFE_AddSceneEdit",e),ATON.FE.popupClose()})),$("#btnDelLocNodes").click((()=>{ATON.Nav.clearLocomotionNodes();ATON.SceneHub.sendEdit({locomotionGraph:{}},ATON.SceneHub.MODE_DEL),ATON.Photon.fireEvent("AFE_ClearLocNodes"),ATON.FE.popupClose()})))},e.popupEmbed=()=>{let e="<div class='atonPopupTitle' style='min-width:300px'>Embed</div>";if(e+="Copy and paste this HTML code in your blog or website to embed an interactive 3D component for this scene<br><br>",e+="<input id='idEmbStaticCover' type='checkbox'>Use static cover<br>",e+="<textarea id='idEmbed' style='width:90%; height:100px; resize:none;' readonly ></textarea><br>",e+="<div class='atonBTN atonBTN-green' style='width:90%' id='btnEmbedCopy'>Copy</div>",!ATON.FE.popupShow("<div class='atonPopupTitle' style='min-width:300px'>Embed</div>Copy and paste this HTML code in your blog or website to embed an interactive 3D component for this scene<br><br><input id='idEmbStaticCover' type='checkbox'>Use static cover<br><textarea id='idEmbed' style='width:90%; height:100px; resize:none;' readonly ></textarea><br><div class='atonBTN atonBTN-green' style='width:90%' id='btnEmbedCopy'>Copy</div>"))return;let t="<iframe style='height:500px; margin:0;' src='"+window.location.href+"' width='100%' height='500px' frameborder='0' allowfullscreen='1'></iframe>",i="<a href='"+window.location.href+"'><img src='"+ATON.PATH_SCENES+ATON.SceneHub.currID+"/cover.png'></a>";$("#idEmbed").val(t),$("#btnEmbedCopy").click((()=>{let e=document.getElementById("idEmbed");e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),ATON.FE.popupClose()})),$("#idEmbStaticCover").on("change",(()=>{$("#idEmbStaticCover").is(":checked")?$("#idEmbed").val(i):$("#idEmbed").val(t)}))},e.popupSettings=()=>{const e="<div class='atonBlockRound' style='display:inline-block; min-width:350px; max-width:800px; min-height:50px; vertical-align:top; padding:10px; background-color:rgba(255,255,255, 0.1)'>";let t="<div class='atonPopupTitle'>Hathor Settings</div>",i=ATON.SUI.getSelectorRadius(),o=ATON.Utils.getHumanReadableDistance(i);ATON.FE.computeSelectorRanges(),t+="<div id='btnEditSwitch' class='atonBTN atonBTN-text atonBTN-orange atonBTN-horizontal' style='display:none'></div>",t+=e,t+="<details><summary><b>3D Selector</b></summary><br>",t+="Radius (<span id='idSelRadTxt'>"+o+"</span>):<br>",t+="<input id='idSelRad' type='range' min='"+ATON.FE._selRanges[0]+"' max='"+ATON.FE._selRanges[1]+"' step='"+ATON.FE._selRanges[0]+"'>",t+="Offset X: <span id='idSeldxTxt'>"+ATON.SUI._selOffset.x.toPrecision(3)+"</span><br>",t+="<input id='idSeldx' type='range' min='"+-ATON.FE._selRanges[1]+"' max='"+ATON.FE._selRanges[1]+"' step='"+ATON.FE._selRanges[0]+"'>",t+="Offset Y: <span id='idSeldyTxt'>"+ATON.SUI._selOffset.y.toPrecision(3)+"</span><br>",t+="<input id='idSeldy' type='range' min='"+-ATON.FE._selRanges[1]+"' max='"+ATON.FE._selRanges[1]+"' step='"+ATON.FE._selRanges[0]+"'>",t+="Offset Z: <span id='idSeldzTxt'>"+ATON.SUI._selOffset.z.toPrecision(3)+"</span><br>",t+="<input id='idSeldz' type='range' min='"+-ATON.FE._selRanges[1]+"' max='"+ATON.FE._selRanges[1]+"' step='"+ATON.FE._selRanges[0]+"'>",t+="<div id='idSelOffReset' class='atonBTN atonBTN-text atonBTN-yellow atonBTN-horizontal'>Reset offsets</div>",t+="</details></div>",ATON.MRes._tsets.length>0&&(t+=e,t+="<details><summary><b>Multiresolution</b></summary><br>",t+="Error target (<span id='idTSerrTxt'>"+ATON.MRes._tsET+"</span>):<br>",t+="More detail&nbsp;<input id='idTSerr' style='width:40%' type='range' min='1.0' max='25.0' step='0.5'>&nbsp;Less detail",ATON.MRes._bPCs&&(t+="<br><br>Point size (<span id='idTSpcsTxt'>"+ATON.MatHub.materials.point.size+"</span>):<br>",t+="<input id='idTSpcs' style='width:100%' type='range' min='0.5' max='10.0' step='0.5'>"),t+="</details></div>"),ATON.FE.popupShow(t)&&(ATON.FE.checkAuth((e=>{let t=e.username;if(t){if(!ATON.SceneHub.currID||!ATON.SceneHub.currID.startsWith(t))return;ATON.SceneHub._bEdit?$("#btnEditSwitch").html("<img id='idPOVmodeIcon' src='"+ATON.FE.PATH_RES_ICONS+"exit.png' class='atonDefIcon'>Quit Editor Mode"):$("#btnEditSwitch").html("<img id='idPOVmodeIcon' src='"+ATON.FE.PATH_RES_ICONS+"edit.png' class='atonDefIcon'>Enter Editor Mode"),$("#btnEditSwitch").show(),$("#btnEditSwitch").click((()=>{ATON.SceneHub._bEdit?(ATON.FE.uiLoadProfile("default"),ATON.FE.popupClose()):(ATON.FE.uiLoadProfile("editor"),ATON.FE.popupClose())}))}})),$("#idSelRad").val(i),$("#idTSerr").val(ATON.MRes._tsET),ATON.MRes._bPCs&&($("#idTSpcs").val(ATON.MatHub.materials.point.size),$("#idTSpcs").on("input change",(()=>{let e=parseFloat($("#idTSpcs").val());ATON.MatHub.materials.point.size=e,$("#idTSpcsTxt").html(e.toPrecision(2))}))),$("#idSelRad").on("input change",(()=>{let e=parseFloat($("#idSelRad").val());ATON.SUI.setSelectorRadius(e),$("#idSelRadTxt").html(ATON.Utils.getHumanReadableDistance(e))})),$("#idSeldx").on("input change",(()=>{let e=parseFloat($("#idSeldx").val());ATON.SUI.setSelectorOffset(e,void 0,void 0),$("#idSeldxTxt").html(e.toPrecision(3))})),$("#idSeldy").on("input change",(()=>{let e=parseFloat($("#idSeldy").val());ATON.SUI.setSelectorOffset(void 0,e,void 0),$("#idSeldyTxt").html(e.toPrecision(3))})),$("#idSeldz").on("input change",(()=>{let e=parseFloat($("#idSeldz").val());ATON.SUI.setSelectorOffset(void 0,void 0,e),$("#idSeldzTxt").html(e.toPrecision(3))})),$("#idTSerr").on("input change",(()=>{let e=parseFloat($("#idTSerr").val());e<=0||(ATON.MRes.setTSetsErrorTarget(e),$("#idTSerrTxt").html(ATON.MRes._tsET))})),$("#idSelOffReset").click((()=>{ATON.SUI.setSelectorOffset(0,0,0),$("#idSeldxTxt").val(0),$("#idSeldyTxt").val(0),$("#idSeldzTxt").val(0),$("#idSeldxTxt").html("0"),$("#idSeldyTxt").html("0"),$("#idSeldzTxt").html("0")})))},e.toggleEditNodes=()=>{e._actState!==e.SELECTION_EDITNODES?(e.startEditNodes(),console.log("ATON NAV CONTROLS: ",ATON.Nav._controls)):(e.stopEditNodes(),ATON.actualEditingNode=void 0)},e.startEditNodes=()=>{ATON.SceneHub.editNodes=!0,ATON.SUI.createMessageLabel("editModeLabelMessage",.5,.2,"Select one node to modify"),ATON.getUINode("editModeLabelMessage").setPosition(1,.4,-1.8)},e.stopEditNodes=()=>{!0===ATON.SceneHub.editNodes&&(ATON.SceneHub.editNodes=!1,ATON.actualEditingNode&&ATON.actualEditingNode.setNowEditing(!1),ATON.getUINode("editModeLabelMessage")&&ATON.getUINode("editModeLabelMessage").hide(),ATON.getUINode("verticalToolbarEditor")&&ATON.getUINode("verticalToolbarEditor").hide())}})();